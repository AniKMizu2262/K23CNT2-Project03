<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Dashboard - Qu·∫£n Tr·ªã NVK</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link rel="stylesheet" href="/css/style.css">
    <style>
        /* Fix ri√™ng cho c√°c Box th·ªëng k√™ nh√¨n g·ªçn h∆°n */
        .stat-box {
            transition: transform 0.2s;
            border: none;
        }

        .stat-box:hover {
            transform: translateY(-5px);
        }

        .stat-icon {
            font-size: 4rem;
            opacity: 0.15;
            transform: rotate(15deg);
            transition: all 0.3s;
        }

        .stat-box:hover .stat-icon {
            transform: rotate(0deg) scale(1.1);
            opacity: 0.25;
        }
    </style>
</head>
<body>

<aside th:replace="~{fragments/sidebar :: sidebar('home')}"></aside>

<div class="content-wrapper">
    <div class="content-header mb-4 p-4 rounded shadow-sm" style="background-color: #1e293b;">
        <div class="container-fluid">
            <div class="row align-items-center py-2">
                <div class="col-sm-8">
                    <h1 class="m-0 text-white fs-3">
                        Xin ch√†o, <span class="text-primary fw-bold" th:text="${session.nvkAdminLogin.nvkFullName}">Admin</span>!
                        üëã
                    </h1>
                    <p class="text-muted mb-0 mt-1">
                        <i class="bi bi-emoji-smile"></i> Ch√∫c b·∫°n m·ªôt ng√†y t·ªët l√†nh v√† l√†m vi·ªác hi·ªáu qu·∫£.
                    </p>
                </div>
                <div class="col-sm-4 text-end">
                    <div class="d-inline-block text-end me-3">
                        <div id="live-time" class="fw-bold fs-5 text-warning">--:--:--</div>
                        <div id="live-date" class="small text-white-50 text-uppercase">...</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="content px-2">
        <div class="row g-4 mb-4">
            <div class="col-lg-3 col-md-6">
                <div class="stat-box bg-primary text-white p-4 rounded-4 shadow-sm h-100 position-relative overflow-hidden d-flex flex-column justify-content-between">
                    <div class="inner z-1">
                        <h3 class="fw-bold mb-1">
                            [[${#numbers.formatDecimal(revenue, 0, 'COMMA', 0, 'POINT')}]]
                            <span class="fs-5 opacity-75">‚Ç´</span>
                        </h3>
                        <p class="mb-0 text-white-50 fw-bold text-uppercase small ls-1">T·ªïng Doanh Thu</p>
                    </div>
                    <div class="icon position-absolute top-0 end-0 p-3 z-0">
                        <i class="bi bi-currency-dollar stat-icon text-white"></i>
                    </div>
                    <a href="/nvkAdmin/order"
                       class="text-white mt-4 d-inline-block small text-decoration-none opacity-75 hover-opacity-100 z-1">
                        Xem chi ti·∫øt <i class="bi bi-arrow-right-circle ms-1"></i>
                    </a>
                </div>
            </div>

            <div class="col-lg-3 col-md-6">
                <div class="stat-box bg-info text-white p-4 rounded-4 shadow-sm h-100 position-relative overflow-hidden d-flex flex-column justify-content-between">
                    <div class="inner z-1">
                        <h3 class="fw-bold mb-1" th:text="${orderCount}">0</h3>
                        <p class="mb-0 text-white-50 fw-bold text-uppercase small ls-1">ƒê∆°n H√†ng M·ªõi</p>
                    </div>
                    <div class="icon position-absolute top-0 end-0 p-3 z-0">
                        <i class="bi bi-bag-check stat-icon text-white"></i>
                    </div>
                    <a href="/nvkAdmin/order"
                       class="text-white mt-4 d-inline-block small text-decoration-none opacity-75 hover-opacity-100 z-1">
                        Xem chi ti·∫øt <i class="bi bi-arrow-right-circle ms-1"></i>
                    </a>
                </div>
            </div>

            <div class="col-lg-3 col-md-6">
                <div class="stat-box bg-warning text-dark p-4 rounded-4 shadow-sm h-100 position-relative overflow-hidden d-flex flex-column justify-content-between">
                    <div class="inner z-1">
                        <h3 class="fw-bold mb-1">
                            [[${#numbers.formatDecimal(avgRating, 1, 1)}]]
                            <i class="bi bi-star-fill fs-5 text-white"></i>
                        </h3>
                        <p class="mb-0 text-dark opacity-75 fw-bold text-uppercase small ls-1">ƒê√°nh Gi√° TB
                            ([[${reviewCount}]])</p>
                    </div>
                    <div class="icon position-absolute top-0 end-0 p-3 z-0">
                        <i class="bi bi-chat-quote stat-icon text-dark"></i>
                    </div>
                    <a href="/nvkAdmin/review"
                       class="text-dark mt-4 d-inline-block small text-decoration-none opacity-75 hover-opacity-100 z-1">
                        Xem chi ti·∫øt <i class="bi bi-arrow-right-circle ms-1"></i>
                    </a>
                </div>
            </div>

            <div class="col-lg-3 col-md-6">
                <div class="stat-box bg-danger text-white p-4 rounded-4 shadow-sm h-100 position-relative overflow-hidden d-flex flex-column justify-content-between">
                    <div class="inner z-1">
                        <h3 class="fw-bold mb-1" th:text="${userCount}">0</h3>
                        <p class="mb-0 text-white-50 fw-bold text-uppercase small ls-1">Kh√°ch H√†ng</p>
                    </div>
                    <div class="icon position-absolute top-0 end-0 p-3 z-0">
                        <i class="bi bi-people stat-icon text-white"></i>
                    </div>
                    <a href="/nvkAdmin/customer"
                       class="text-white mt-4 d-inline-block small text-decoration-none opacity-75 hover-opacity-100 z-1">
                        Xem chi ti·∫øt <i class="bi bi-arrow-right-circle ms-1"></i>
                    </a>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-12">
                <div class="card border-0 shadow-lg rounded-3 overflow-hidden" style="background-color: #1e293b;">
                    <div class="card-header bg-transparent border-bottom border-secondary py-3">
                        <h5 class="card-title mb-0 fw-bold text-primary">
                            <i class="bi bi-clock-history me-2"></i> ƒê∆°n h√†ng v·ª´a ƒë·∫∑t
                        </h5>
                    </div>
                    <div class="card-body p-0">
                        <div class="table-responsive">
                            <table class="table table-dark table-hover align-middle mb-0 text-white"
                                   style="background-color: transparent;">
                                <thead class="text-secondary text-uppercase small" style="background-color: #0f172a;">
                                <tr>
                                    <th class="ps-4 py-3">M√£ ƒê∆°n</th>
                                    <th>Kh√°ch h√†ng</th>
                                    <th>Ng√†y ƒë·∫∑t</th>
                                    <th>T·ªïng ti·ªÅn</th>
                                    <th>Tr·∫°ng th√°i</th>
                                    <th>H√†nh ƒë·ªông</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr th:each="order : ${recentOrders}" style="border-bottom: 1px solid #334155;">
                                    <td class="ps-4 fw-bold text-info">#[[${order.nvkCode}]]</td>
                                    <td class="fw-bold">[[${order.nvkCustomer?.nvkFullName}]]</td>
                                    <td class="text-white-50"
                                        th:text="${#temporals.format(order.nvkCreatedDate, 'dd/MM/yyyy HH:mm')}"></td>
                                    <td class="fw-bold text-success">
                                        [[${#numbers.formatDecimal(order.nvkTotalAmount, 0, 'COMMA', 0, 'POINT')}]] ‚Ç´
                                    </td>
                                    <td>
                                        <span th:if="${order.nvkStatus == 0}" class="badge bg-warning text-dark"><i
                                                class="bi bi-hourglass-split"></i> Ch·ªù duy·ªát</span>
                                        <span th:if="${order.nvkStatus == 1}" class="badge bg-info"><i
                                                class="bi bi-check2-circle"></i> ƒê√£ x√°c nh·∫≠n</span>
                                        <span th:if="${order.nvkStatus == 2}" class="badge bg-primary"><i
                                                class="bi bi-truck"></i> ƒêang giao</span>
                                        <span th:if="${order.nvkStatus == 3}" class="badge bg-success"><i
                                                class="bi bi-check-circle-fill"></i> Ho√†n th√†nh</span>
                                        <span th:if="${order.nvkStatus == 4}" class="badge bg-danger"><i
                                                class="bi bi-x-circle-fill"></i> ƒê√£ h·ªßy</span>
                                    </td>
                                    <td>
                                        <a th:href="@{/nvkAdmin/order/detail/{id}(id=${order.nvkId})}"
                                           class="btn btn-sm btn-outline-light rounded-pill px-3">
                                            Chi ti·∫øt
                                        </a>
                                    </td>
                                </tr>
                                <tr th:if="${recentOrders.empty}">
                                    <td colspan="6" class="text-center py-5 text-muted">
                                        <i class="bi bi-inbox fs-1 d-block mb-3 opacity-50"></i>
                                        Ch∆∞a c√≥ ƒë∆°n h√†ng n√†o m·ªõi.
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    function updateClock() {
        const now = new Date();
        document.getElementById('live-time').innerText = now.toLocaleTimeString('vi-VN');
        document.getElementById('live-date').innerText = now.toLocaleDateString('vi-VN', {
            weekday: 'long',
            day: '2-digit',
            month: 'long',
            year: 'numeric'
        });
    }

    updateClock();
    setInterval(updateClock, 1000);
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>