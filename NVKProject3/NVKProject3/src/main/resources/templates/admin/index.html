<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Dashboard - Qu·∫£n Tr·ªã</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>

<aside th:replace="~{fragments/sidebar :: sidebar('home')}"></aside>

<div class="content-wrapper">
    <div class="content-header mb-4 p-4 rounded">
        <div class="container-fluid">
            <div class="row align-items-center py-3">
                <div class="col-sm-8">
                    <h1 class="m-0 text-dark fs-3">
                        Xin ch√†o, <span class="text-primary fw-bold" th:text="${session.nvkAdminLogin.nvkFullName}">Admin</span>!
                        üëã
                    </h1>
                    <p class="text-muted mb-0 mt-1">
                        <i class="bi bi-emoji-smile"></i> Ch√∫c b·∫°n m·ªôt ng√†y t·ªët l√†nh v√† l√†m vi·ªác hi·ªáu qu·∫£.
                    </p>
                </div>
                <div class="col-sm-4 text-end">
                    <div class="d-inline-block text-end me-3">
                        <div id="live-time" class="fw-bold fs-5 text-dark">--:--:--</div>
                        <div id="live-date" class="small text-muted text-uppercase">...</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="content px-2">
        <div class="row g-3 mb-4">
            <div class="col-lg-3 col-6">
                <div class="small-box bg-primary text-white p-3 rounded shadow-sm h-100 position-relative overflow-hidden">
                    <div class="inner">
                        <h3 th:text="${#numbers.formatDecimal(revenue, 0, 'COMMA', 0, 'POINT')} + ' ‚Ç´'">0 ‚Ç´</h3>
                        <p class="mb-0">T·ªïng Doanh Thu</p>
                    </div>
                    <div class="icon position-absolute top-0 end-0 p-3 opacity-25"><i
                            class="bi bi-currency-dollar fs-1"></i></div>
                    <a href="/nvkAdmin/order"
                       class="small-box-footer text-white mt-2 d-block small text-decoration-none">
                        Chi ti·∫øt <i class="bi bi-arrow-right"></i>
                    </a>
                </div>
            </div>

            <div class="col-lg-3 col-6">
                <div class="small-box bg-info text-white p-3 rounded shadow-sm h-100 position-relative overflow-hidden">
                    <div class="inner">
                        <h3 th:text="${orderCount}">0</h3>
                        <p class="mb-0">ƒê∆°n H√†ng M·ªõi</p>
                    </div>
                    <div class="icon position-absolute top-0 end-0 p-3 opacity-25"><i class="bi bi-bag fs-1"></i></div>
                    <a href="/nvkAdmin/order"
                       class="small-box-footer text-white mt-2 d-block small text-decoration-none">
                        Chi ti·∫øt <i class="bi bi-arrow-right"></i>
                    </a>
                </div>
            </div>

            <div class="col-lg-3 col-6">
                <div class="small-box bg-warning text-dark p-3 rounded shadow-sm h-100 position-relative overflow-hidden">
                    <div class="inner">
                        <h3>[[${#numbers.formatDecimal(avgRating, 1, 1)}]] <i class="bi bi-star-fill fs-6"></i></h3>
                        <p class="mb-0">ƒê√°nh Gi√° TB ([[${reviewCount}]])</p>
                    </div>
                    <div class="icon position-absolute top-0 end-0 p-3 opacity-25"><i class="bi bi-chat-heart fs-1"></i>
                    </div>
                    <a href="/nvkAdmin/review"
                       class="small-box-footer text-dark mt-2 d-block small text-decoration-none">
                        Chi ti·∫øt <i class="bi bi-arrow-right"></i>
                    </a>
                </div>
            </div>

            <div class="col-lg-3 col-6">
                <div class="small-box bg-danger text-white p-3 rounded shadow-sm h-100 position-relative overflow-hidden">
                    <div class="inner">
                        <h3 th:text="${userCount}">0</h3>
                        <p class="mb-0">Kh√°ch H√†ng</p>
                    </div>
                    <div class="icon position-absolute top-0 end-0 p-3 opacity-25"><i
                            class="bi bi-person-plus fs-1"></i></div>
                    <a href="/nvkAdmin/customer"
                       class="small-box-footer text-white mt-2 d-block small text-decoration-none">
                        Chi ti·∫øt <i class="bi bi-arrow-right"></i>
                    </a>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-12">
                <div class="card border-0 shadow-sm">
                    <div class="card-header bg-white py-3">
                        <h5 class="card-title mb-0 fw-bold text-primary"><i class="bi bi-clock-history me-2"></i>ƒê∆°n
                            h√†ng v·ª´a ƒë·∫∑t</h5>
                    </div>
                    <div class="card-body p-0">
                        <div class="table-responsive">
                            <table class="table table-hover align-middle mb-0">
                                <thead class="table-light">
                                <tr>
                                    <th class="ps-4">M√£ ƒê∆°n</th>
                                    <th>Kh√°ch h√†ng</th>
                                    <th>Ng√†y ƒë·∫∑t</th>
                                    <th>T·ªïng ti·ªÅn</th>
                                    <th>Tr·∫°ng th√°i</th>
                                    <th>H√†nh ƒë·ªông</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr th:each="order : ${recentOrders}">
                                    <td class="ps-4 fw-bold text-primary">[[${order.nvkCode}]]</td>
                                    <td>[[${order.nvkCustomer?.nvkFullName}]]</td>
                                    <td th:text="${#temporals.format(order.nvkCreatedDate, 'dd/MM/yyyy HH:mm')}"></td>
                                    <td class="fw-bold text-success">[[${#numbers.formatDecimal(order.nvkTotalAmount, 0,
                                        'COMMA', 0, 'POINT')}]] ‚Ç´
                                    </td>
                                    <td>
                                        <span th:if="${order.nvkStatus == 0}" class="badge bg-warning text-dark">Ch·ªù duy·ªát</span>
                                        <span th:if="${order.nvkStatus == 1}" class="badge bg-info">ƒê√£ x√°c nh·∫≠n</span>
                                        <span th:if="${order.nvkStatus == 2}" class="badge bg-primary">ƒêang giao</span>
                                        <span th:if="${order.nvkStatus == 3}" class="badge bg-success">Ho√†n th√†nh</span>
                                        <span th:if="${order.nvkStatus == 4}" class="badge bg-danger">ƒê√£ h·ªßy</span>
                                    </td>
                                    <td>
                                        <a th:href="@{/nvkAdmin/order/detail/{id}(id=${order.nvkId})}"
                                           class="btn btn-sm btn-outline-primary">
                                            <i class="bi bi-eye"></i>
                                        </a>
                                    </td>
                                </tr>
                                <tr th:if="${recentOrders.empty}">
                                    <td colspan="6" class="text-center py-4 text-muted">Ch∆∞a c√≥ ƒë∆°n h√†ng n√†o m·ªõi.</td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    function updateClock() {
        const now = new Date();
        document.getElementById('live-time').innerText = now.toLocaleTimeString('vi-VN');
        document.getElementById('live-date').innerText = now.toLocaleDateString('vi-VN', {
            weekday: 'long',
            day: '2-digit',
            month: 'long',
            year: 'numeric'
        });
    }

    updateClock();
    setInterval(updateClock, 1000);
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>