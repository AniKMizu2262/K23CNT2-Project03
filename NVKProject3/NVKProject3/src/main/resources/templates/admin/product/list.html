<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Sản phẩm</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link rel="stylesheet" href="/css/style.css">
</head>
<body class="bg-body">

<aside th:replace="~{fragments/sidebar :: sidebar('product')}"></aside>

<div class="content-wrapper">

    <div class="content-header mb-4 p-4 rounded shadow-sm d-flex justify-content-between align-items-center">
        <div class="d-flex align-items-center gap-3">
            <button class="btn btn-outline-secondary border-0"
                    onclick="document.body.classList.toggle('sidebar-closed')" title="Menu">
                <i class="bi bi-list fs-4"></i>
            </button>
            <div>
                <h1 class="fw-bold fs-3 m-0">Danh sách Sản phẩm</h1>
                <small class="text-muted">Quản lý kho hàng và giá cả niêm yết</small>
            </div>
        </div>

        <a href="/nvkAdmin/product/create" class="btn btn-primary fw-bold shadow-sm px-3">
            <i class="bi bi-plus-lg me-1"></i> Thêm mới
        </a>
    </div>

    <div class="content">
        <div class="card shadow-lg border-0">

            <div class="card-header py-3 bg-transparent border-bottom">
                <h6 class="m-0 font-weight-bold text-primary text-uppercase small">
                    <i class="bi bi-box-seam-fill me-1"></i> Kho hàng hiện tại
                </h6>
            </div>

            <div class="card-body p-0 table-responsive">
                <table class="table table-hover mb-0 align-middle">
                    <thead>
                    <tr class="text-uppercase small text-muted">
                        <th class="text-center py-3" width="5%">Ảnh</th>
                        <th class="py-3">Thông tin sản phẩm</th>
                        <th class="text-end py-3">Giá bán</th>
                        <th class="text-center py-3">Tồn kho</th>
                        <th class="text-center py-3">Trạng thái</th>
                        <th class="text-center py-3">Thao tác</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="p : ${nvkProducts}">
                        <td class="text-center">
                            <img th:src="${p.nvkImgUrl != null && p.nvkImgUrl != '' ? p.nvkImgUrl : 'https://ui-avatars.com/api/?name=' + p.nvkName + '&background=random&size=128'}"
                                 width="50" height="50"
                                 class="rounded border shadow-sm"
                                 style="object-fit: cover;"
                                 onerror="this.onerror=null; this.src='https://ui-avatars.com/api/?name=Product&background=random';">
                        </td>

                        <td>
                            <div class="d-flex flex-column">
                                <span class="fw-bold text-primary">[[${p.nvkName}]]</span>
                                <div class="small mt-1">
                                        <span class="badge border border-secondary text-info bg-transparent fw-normal me-2">
                                            <i class="bi bi-qr-code me-1"></i>[[${p.nvkCode}]]
                                        </span>
                                    <span class="text-muted"><i
                                            class="bi bi-tag-fill me-1"></i> [[${p.nvkBrand}]]</span>
                                </div>
                            </div>
                        </td>

                        <td class="text-end fw-bold text-danger">
                            [[${#numbers.formatDecimal(p.nvkPrice, 0, 'COMMA', 0, 'POINT')}]] ₫
                        </td>

                        <td class="text-center">
                            <span class="fw-bold text-light">[[${p.nvkQuantity}]]</span>
                        </td>

                        <td class="text-center">
                            <span th:if="${p.nvkStatus==1}"
                                  class="badge rounded-pill bg-success bg-opacity-75">Đang bán</span>
                            <span th:if="${p.nvkStatus==0}"
                                  class="badge rounded-pill bg-danger bg-opacity-75">Ngừng bán</span>
                            <span th:if="${p.nvkStatus==2}"
                                  class="badge rounded-pill bg-warning text-dark bg-opacity-75">Sắp về</span>
                        </td>

                        <td class="text-center">
                            <a th:href="@{/nvkAdmin/product/edit/{id}(id=${p.nvkId})}"
                               class="btn btn-sm btn-outline-info border-0" title="Sửa">
                                <i class="bi bi-pencil-square fs-5"></i>
                            </a>
                            <a th:href="@{/nvkAdmin/product/delete/{id}(id=${p.nvkId})}"
                               class="btn btn-sm btn-outline-danger border-0 ms-1"
                               onclick="return confirm('Bạn có chắc muốn xóa sản phẩm này không?');" title="Xóa">
                                <i class="bi bi-trash fs-5"></i>
                            </a>
                        </td>
                    </tr>

                    <tr th:if="${#lists.isEmpty(nvkProducts)}">
                        <td colspan="6" class="text-center py-5 text-muted">
                            <i class="bi bi-box2 fs-1 d-block mb-3 opacity-50"></i>
                            <p class="mb-0">Kho hàng đang trống.</p>
                            <a href="/nvkAdmin/product/create" class="btn btn-sm btn-primary mt-2">Nhập hàng ngay</a>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<script>function toggleSidebar() {
    document.body.classList.toggle('sidebar-closed');
}</script>
</body>
</html>