<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Form Sản phẩm</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
<aside class="sidebar">
    <a href="/nvkAdmin" class="sidebar-brand"><i class="bi bi-shield-check text-primary"></i><span>NVK-ADMIN</span></a>
    <div class="sidebar-content">
        <div class="user-panel">
            <img th:if="${session.nvkAdminLogin.nvkAvatar != null}" th:src="${session.nvkAdminLogin.nvkAvatar}" class="user-avatar">
            <img th:unless="${session.nvkAdminLogin.nvkAvatar != null}" src="/images/sbcf-default-avatar.webp" class="user-avatar">
            <div class="user-info"><div th:text="${session.nvkAdminLogin.nvkFullName}">Admin</div><small class="text-success"><i class="bi bi-circle-fill" style="font-size:8px"></i> Online</small></div>
        </div>
        <nav class="mt-2 px-2">
            <a href="/nvkAdmin" class="nav-link">Dashboard</a>
            <div class="nav-header">QUẢN LÝ KHO</div>
            <a href="/nvkAdmin/category" class="nav-link">Danh Mục</a>
            <a href="/nvkAdmin/product" class="nav-link active">Sản Phẩm</a>
            <div class="nav-header">KINH DOANH</div>
            <a href="/nvkAdmin/customer" class="nav-link"><i class="bi bi-people-fill me-2"></i> Khách Hàng</a>
            <a href="/nvkAdmin/order" class="nav-link"><i class="bi bi-cart-fill me-2"></i> Đơn Hàng</a>
            <div class="nav-header">HỆ THỐNG</div>
            <a href="/nvkAdmin/accounts" class="nav-link"><i class="bi bi-shield-lock-fill me-2"></i> Admin Accounts</a>
        </nav>
    </div>
    <div class="sidebar-footer"><a href="/nvkLogout" class="nav-link text-danger"><i class="bi bi-box-arrow-right me-2"></i> Đăng xuất</a></div>
</aside>

<div class="content-wrapper">
    <nav class="main-header">
        <ul class="list-unstyled m-0 d-flex align-items-center">
            <li><a class="nav-link text-dark" href="#" onclick="document.body.classList.toggle('sidebar-closed')"><i class="bi bi-list fs-4"></i></a></li>
            <li class="ms-3 fw-bold text-dark" th:text="${nvkProduct.nvkId != null ? 'Cập nhật Sản phẩm' : 'Thêm mới Sản phẩm'}"></li>
        </ul>
        <a href="/nvkAdmin/product" class="btn btn-sm btn-secondary">Quay lại danh sách</a>
    </nav>

    <section class="content px-3 mt-4">
        <form th:action="@{/nvkAdmin/product/save}" th:object="${nvkProduct}" method="post" enctype="multipart/form-data">
            <input type="hidden" th:field="*{nvkId}">
            <input type="hidden" th:field="*{nvkImgUrl}">

            <div class="row">
                <div class="col-md-8">
                    <div class="card card-primary">
                        <div class="card-header bg-primary text-white">
                            <h3 class="card-title mb-0">Thông tin chung</h3>
                        </div>
                        <div class="card-body">
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label class="form-label">Mã sản phẩm <span class="text-danger">*</span></label>
                                    <input type="text" th:field="*{nvkCode}" class="form-control" placeholder="VD: IP15" required>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">Tên sản phẩm <span class="text-danger">*</span></label>
                                    <input type="text" th:field="*{nvkName}" class="form-control" required>
                                </div>
                            </div>

                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label class="form-label">Giá bán (VNĐ) <span class="text-danger">*</span></label>
                                    <div class="input-group">
                                        <input type="number" name="nvkPrice" th:value="${nvkProduct.nvkPrice != null ? #numbers.formatDecimal(nvkProduct.nvkPrice, 0, 0) : ''}" class="form-control" required>
                                        <span class="input-group-text">đ</span>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">Giá gốc (Gạch ngang)</label>
                                    <div class="input-group">
                                        <input type="number" name="nvkOldPrice" th:value="${nvkProduct.nvkOldPrice != null ? #numbers.formatDecimal(nvkProduct.nvkOldPrice, 0, 0) : ''}" class="form-control">
                                        <span class="input-group-text">đ</span>
                                    </div>
                                </div>
                            </div>

                            <div class="mb-3">
                                <label class="form-label">Mô tả / Cấu hình</label>
                                <textarea th:field="*{nvkDescription}" class="form-control" rows="5" placeholder="Nhập thông số kỹ thuật..."></textarea>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="card">
                        <div class="card-header fw-bold">Phân loại</div>
                        <div class="card-body">
                            <div class="mb-3">
                                <label class="form-label">Danh mục</label>
                                <select th:field="*{nvkCategory}" class="form-select">
                                    <option value="">-- Chọn --</option>
                                    <option th:each="cat : ${nvkCategories}" th:value="${cat.nvkId}" th:text="${cat.nvkName}"></option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Hãng sản xuất</label>
                                <input type="text" th:field="*{nvkBrand}" class="form-control" placeholder="Apple, Samsung...">
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Số lượng kho</label>
                                <input type="number" th:field="*{nvkQuantity}" class="form-control" value="10">
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header fw-bold">Hình ảnh & Trạng thái</div>
                        <div class="card-body">
                            <div class="mb-3">
                                <label class="form-label">Ảnh đại diện</label>
                                <input type="file" name="nvkImageFile" class="form-control mb-2">
                                <div class="text-center border rounded p-2 bg-light" th:if="${nvkProduct.nvkImgUrl != null}">
                                    <img th:src="${nvkProduct.nvkImgUrl}" class="img-fluid" style="max-height: 150px;">
                                </div>
                            </div>
                            <div class="mb-3">
                                <label class="form-label d-block">Trạng thái</label>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" th:field="*{nvkStatus}" value="1">
                                    <label class="form-check-label text-success">Bán</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" th:field="*{nvkStatus}" value="2">
                                    <label class="form-check-label text-warning">Sắp về</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" th:field="*{nvkStatus}" value="0">
                                    <label class="form-check-label text-danger">Ngừng</label>
                                </div>
                            </div>
                            <hr>
                            <button type="submit" class="btn btn-primary w-100 fw-bold">LƯU SẢN PHẨM</button>
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </section>
</div>

<script>function toggleSidebar() { document.body.classList.toggle('sidebar-closed'); }</script>
</body>
</html>