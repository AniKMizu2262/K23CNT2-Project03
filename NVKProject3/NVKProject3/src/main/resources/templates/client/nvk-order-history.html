<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/client/head :: head}"></head>

<body style="background-color: #1a1d29; color: #fff;">

<nav th:replace="~{fragments/client/header :: header}"></nav>

<main class="py-5">
    <div class="container">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h2 class="fw-bold text-white"><i class="bi bi-clock-history me-2"></i> Lịch sử mua hàng</h2>
            <a href="/" class="btn btn-outline-light rounded-pill"><i class="bi bi-arrow-left me-2"></i> Mua tiếp</a>
        </div>

        <div th:if="${param.success}" class="alert alert-success rounded-3 mb-4">
            <i class="bi bi-check-circle-fill me-2"></i> Đã hủy đơn hàng thành công!
        </div>

        <div class="card border-0 shadow-lg rounded-4 overflow-hidden" style="background-color: #262b3c; color: white;">
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table table-dark table-hover mb-0 align-middle text-center">
                        <thead class="text-secondary text-uppercase small">
                        <tr>
                            <th class="py-3">Mã đơn</th>
                            <th class="py-3">Ngày đặt</th>
                            <th class="py-3">Người nhận</th>
                            <th class="py-3">Tổng tiền</th>
                            <th class="py-3">Trạng thái</th>
                            <th class="py-3">Hành động</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr th:each="o : ${nvkOrders}">
                            <td class="fw-bold text-info">[[${o.nvkCode}]]</td>
                            <td class="text-white-50">[[${#temporals.format(o.nvkCreatedDate, 'dd/MM/yyyy HH:mm')}]]
                            </td>
                            <td>[[${o.nvkReceiverName}]]</td>
                            <td class="fw-bold text-warning">[[${#numbers.formatDecimal(o.nvkTotalAmount, 0, 'COMMA', 0,
                                'POINT')}]] ₫
                            </td>

                            <td>
                                <span th:if="${o.nvkStatus == 0}" class="badge bg-secondary">Chờ xác nhận</span>
                                <span th:if="${o.nvkStatus == 1}" class="badge bg-primary">Đã xác nhận</span>
                                <span th:if="${o.nvkStatus == 2}" class="badge bg-info text-dark">Đang giao</span>
                                <span th:if="${o.nvkStatus == 3}" class="badge bg-success">Hoàn thành</span>
                                <span th:if="${o.nvkStatus == 4}" class="badge bg-danger">Đã hủy</span>
                            </td>

                            <td>
                                <a th:href="@{/nvk-order/detail/{id}(id=${o.nvkId})}"
                                   class="btn btn-sm btn-outline-primary rounded-pill px-3">
                                    Chi tiết
                                </a>
                                <a th:if="${o.nvkStatus == 0}"
                                   th:href="@{/nvk-order/cancel/{id}(id=${o.nvkId})}"
                                   class="btn btn-sm btn-outline-danger rounded-pill px-3 ms-1"
                                   onclick="return confirm('Bạn chắc chắn muốn hủy đơn này?');">
                                    Hủy
                                </a>
                            </td>
                        </tr>

                        <tr th:if="${#lists.isEmpty(nvkOrders)}">
                            <td colspan="6" class="py-5 text-muted">
                                <i class="bi bi-inbox fs-1 d-block mb-3"></i>
                                Bạn chưa có đơn hàng nào.
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</main>

<footer th:replace="~{fragments/client/footer :: footer}"></footer>
</body>
</html>